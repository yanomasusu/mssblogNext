---
meta: metadata
hash: {key: val}
array: [1, 2, 3]
title: 意外と躓いたサーバ設定その１
date: 2024-04-10
---
# 意外と躓いたサーバ設定その１
---
## #maincontent
やあやあ、MSSですよ。

next.js使ったコンテンツ生成部分は、ほんとに最低限ではあるけど完成、というところでデプロイ（そんな御大層なものではないけど）先の環境を整備してました。

これまでのBLOGは、さくらレンタルサーバだったんですが、今回はだいぶ昔からひっそりと借りていたさくらVPSを再利用することにしました。

OSの再インストールから、必要なソフト（つーてもWebサーバだけ）入れて、ネットワーク設定すれば完成やー

・・・・・・って思ってたら躓いた。

- 現象：SSHをポート指定すると繋がらない

---

デフォルトの22は使いたくないので別のポートにするつもりで、設定したら繋がらない。

となるとファイアウォール？インストール直後の状態で動いてるもんなの普通？と思いながら調べてみてもよくわからない。
（linuxのお作法にはまだまだ知識が足りてません）

過去に扱ったことのあるFWといえばiptables、firewalld、そのくらいなんだけど、どちらも動いてない。そうだよねｗ

なんらかのデフォルトみたいなものが働いている？ということで設定をしてやりましょうと、最近はufwってラッパー使っちゃうのが多いみたいな気配がしたので、触ったことないしせっかくだから入れてみる。

あー、これは楽ですね・・・・

・・・・やっぱり繋がらないですね。

頭を抱えること数時間、結果としては「さくらのVPSコントロールパネルで設定ができる」というオチでした。

構成としては、詳しいことは省いて、まずさくらVPSのFWしか動いてなかった。

自前でFWを設置・設定したいひとは、それをオフにもできる、という代物が、入口に鎮座しておられた、というだけのことでした。

というわけで、SSHとついでにhtmlもポート開けてすべて解決。

---

ついでにデプロイ（もどき）も自動化して、スクリプトでssh、scpを使って一撃で終わるようにしてみた。

ほんとはrsyncというコマンドがあるようなのでそれ使ってみたいんだけど、ポート指定がらみでうまく動いてくれない原因がよくわからなかったので、延期。